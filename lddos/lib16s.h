/**************************************************************
 *      lib16.h        Copyright(C) 2003-2018 Max Wu
 *
 * Header file loader from MS-DOS
 *
 **************************************************************/

#ifndef LIB16S_H
#define LIB16S_H

///////////////////////////////////////////////////////////////
// Include files
///////////////////////////////////////////////////////////////
/**************************************************************
 * None
 **************************************************************/

///////////////////////////////////////////////////////////////
// data structure
///////////////////////////////////////////////////////////////
/**************************************************************
 * None
 **************************************************************/

///////////////////////////////////////////////////////////////
// global variable
///////////////////////////////////////////////////////////////
/**************************************************************
 * Version comment
 **************************************************************/
#define VERSION         "0.5.00"

/**************************************************************
 * Descriptor related define
 **************************************************************/
#define UNREAL_SEL      (1<<3)
#define REAL_SEL        (3<<3)

/**************************************************************
 * image related define
 **************************************************************/
#define BUFF_SIZE       0x20

///////////////////////////////////////////////////////////////
// global function
///////////////////////////////////////////////////////////////
/**************************************************************
 * A20 related Functions
 **************************************************************/
#if(A20_TEST)
#define X86_A20_TEST(exit_addr) call    x86_a20_test;           \
                                cmp     $00,            %al;    \
                                jne     exit_addr;
#define X86_A20_ENABLE()        call    x86_a20_enable
#else   // A20_TEST
#define X86_A20_TEST(exit_addr)
#define X86_A20_ENABLE()
#endif  // A20_TEST
#define X86_E820_GET()          call    x86_e820_get

// DOS related Functions
#if(DOS_API)
#else   // DOS_API
#endif  // DOS_API

// BIOS related Functions
#if(BIOS_API)
#else   // BIOS_API
#endif  // BIOS_API

///////////////////////////////////////////////////////////////
// static inline function
///////////////////////////////////////////////////////////////
/**************************************************************
 * None
 **************************************************************/

///////////////////////////////////////////////////////////////
// debug function
///////////////////////////////////////////////////////////////
#if(DEBUG)
#define DBG16_CALL(symbol)      call    symbol
#define DBG16_PUTSTR(string)    mov     $string,    %si;    call    bios_putstr
#define DBG16_PUTREG(reg)       push    %ax;                \
                                mov     %reg,       %ax;    \
                                call    lib16_putreg16;     \
                                pop     %ax

#else   // DEBUG
#define DBG16_CALL(symbol)
#define DBG16_PUTSTR(string)
#define DBG16_PUTREG(reg)

#endif  // DEBUG

///////////////////////////////////////////////////////////////
// static inline function
///////////////////////////////////////////////////////////////
/**************************************************************
 * None
 **************************************************************/

#endif // LIB16S_H

///////////////////////////////////////////////////////////////
// LOG
///////////////////////////////////////////////////////////////
// 2004 05 22 -- 0003 add new function x86_a20_enable
// 2004 05 22 -- 0002 fix A20 testing routine
// 2004 02 01 -- 0001 creat this log
